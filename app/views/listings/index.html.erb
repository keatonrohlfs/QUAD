<h1>Listings</h1>

<div class="search-container">
  <%= form_tag(listings_path, method: :get) do %>
    <%= text_field_tag :search, params[:search], placeholder: "Search by name" %>
    <%= submit_tag "Search", name: nil, class: "search-button" %>
  <% end %>
</div>

<div class="sorting">
  <%= form_with url: listings_path, method: :get, local: true do |form| %>
    <%= form.select :sort_by, options_for_select([
      ['Date (Newest to Oldest)', 'created_at_desc'],
      ['Date (Oldest to Newest)', 'created_at_asc'],
      ['Title (A-Z)', 'title_asc'],
      ['Title (Z-A)', 'title_desc'],
      ['Price (Low to High)', 'price_asc'],
      ['Price (High to Low)', 'price_desc']
    ], selected: params[:sort_by]), {}, onchange: 'this.form.submit()' %>
  <% end %>
</div>

<div class="content">
  <% @listings.each do |listing| %>
    <div class="box">
      <%= render partial: 'listings/listing', locals: {listing: listing} %>
      <% if listing.status == "Unverified" %>
        <%= button_to "VERIFY LISTING", listing_path(listing), method: :put, class: 'verify-button' %>
      <% end %>
    </div>
  <% end %>
</div>
